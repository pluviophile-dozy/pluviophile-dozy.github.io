<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" type="text/css" href="vendors/css/normalize.css">
        <link rel="stylesheet" type="text/css" href="vendors/css/grid.css">
        <link rel="stylesheet" type="text/css" href="vendors/css/ionicons.min.css">
        <link rel="stylesheet" type="text/css" href="vendors/css/animate.css">
        <link rel="stylesheet" type="text/css" href="static/css/index.css">
        <link rel="stylesheet" type="text/css" href="static/css/queries.css">
        
        <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,300italic' rel='stylesheet' type='text/css'>
        <title>플루비오파일</title>
        
    </head>
    <style>
.main-nav li a:link,
.main-nav li a:visited {
    color: #000;
    border-bottom: 2px solid transparent;
    -webkit-transition: border-bottom 0.2s;
    transition: border-bottom 0.2s;
}
        
        .checko a {
            border: none;
        }

.main-nav li a:hover,
.main-nav li a:active {
    border-bottom: 2px solid #000;
}
        
.active {
    padding-bottom: 8px;
    border-bottom: 2px solid #000;
}

    </style>  
    <body>
        <header>
            <nav>
                <div class="row logolol">
                    <a href="index.html"><img src="static/img/logo_plu_black.png" class="logo"></a>
                    <a href="index.html"><img src="static/img/logo_plu.png" alt="Pluviophile" class="logo-black"></a>
                    <ul class="main-nav js--main-nav">
                        <li><a href="index.html">Main</a></li>
                        <li><a href="about.html">About</a></li>
                        <li class="active"><a href="dozy.html">Dozy</a></li>
                        <li><a href="as.html">A/S</a></li>
                        <li><a href="contact.html">COntact</a></li>
                        <li><a href="resource.html"><div class="res">resource</div></a></li>
                    </ul>
                    <a class="mobile-nav-icon js--nav-icon"><i class="ion-navicon-round"></i></a>
                </div>
            </nav>            
        </header>

        <section class="section-form">
            <div class="row js--wp-1 tongpan">
                <h3>도지 통판 안내</h3>
                <h4>정식 런칭 전 여러분의 성원에 보답하고자 할인 가격으로 1회 통판을 진행합니다.</h4>
                <br>
                <h4>통판 종료까지 <span id="demo"></span>남았습니다.</h4>
                <br>
            </div>
            
            <button href="#" class="float" onclick="myFunction()">주문하기
            </button>   
            <button href="#" class=" mob" onclick="myFunction2()">주문하기
            </button> 
            <div href="#" class="floating" id="orderpage">
            <form method="post" action="#" class="order-form">
                <h4>주문서</h4>
                <a class="close" href="#" onclick="closefunc()">×</a>
            <table class="orderchoice">
            <col style=”width:50%;”>
            <col style=”width:50%;”>
              <tr class="btmborder">
                <th>주문 제품</th>
                <th>수량</th>
              </tr>
              <tr>
                <td>코지 세트</td>
                <td><input class="qty" id="cozy" name="cozy" type="number" placeholder="0"></td>
              </tr>
              <tr>
                <td>도지 세트</td>
                <td><input class="qty" id="dozy" name="dozy" type="number" placeholder="0"></td>
              </tr>
            <tr>
                <td>도지코지 세트</td>
                <td><input class="qty" id="docozy" name="docozy" type="number" placeholder="0"></td>
              </tr>
            </table>
                         
            <h4 class="btmborder lefttab topspace">주문자 정보</h4>
            
            <table class="orderchoice2">
            <colgroup>
            <col style=”width:40%;”>
            <col style=”width:60%;”>
            </colgroup>
              <tr>
                <td width="30%">이름</td>
                <td width="70%"><input name="name" type="text" placeholder="홍길동"></td>
              </tr>
              <tr>
                <td>휴대전화</td>
                <td><input name="tel" type="text" placeholder="010-3975-0741"></td>
              </tr>
            <tr>
                <td>우편번호</td>
                <td>
 <input type="text" name="zip"/>
<button type="button" style="width:60px; height:32px; background-color:#1B1F5B;color: white;" onclick="openZipSearch()">검색</button><br>
</td>
              </tr>
                <tr>
                <td>주소</td>
                <td>
<input type="text" name="addr1" ></td>
              </tr>
                <tr>
                <td>상세주소</td>
                <td>
<input type="text" name="addr2"></td>
              </tr>
            </table>        
        <br>
           <table class="orderchoice">
            <colgroup>
            <col style=”width:40%;”>
            <col style=”width:60%;”>
            </colgroup>
              <tr class="topspacey btmborder">
                <th  width="40%">결제금액</th>
                <th width="60%"></th>
              </tr>
              <tr>
                <td>공급가액</td>
                <td class="righttab"><span id="addedamount"></span>원</td>
              </tr>
              <tr>
                <td>배송비</td>
                <td class="righttab">3,000원</td>
              </tr>

            </table>
         <br>
            <table class="orderchoice">
              <tr class="topspace btmborder">
                <th width="50%">입금 예정 금액</th>
                <th width="50%" class="righttab"><span id="finalamount" name="finalamount"></span>원<input id="finalamount2" type="hidden" name="finalamount2" value="0"></th>
              </tr>
              <tr>
                <td width="30%">입금자명</td>
                <td width="70%"><input name="name_bank" type="text" placeholder="홍길동"></td>
              </tr>
            </table>
            <div class="checko">
            <input class="checkout" type="button" onclick="sendEmail()" value="결제하기"> </div> 
                </form>
            </div>
            
            
            <div class="row js--wp-1 detailpage">
            <img src="static/img/detailpage_1.png">
            <img src="static/img/detailpage_2.png">
            </div>
        </section>
        
<html>

<body>  
        
        <footer>
            <div class="row foot">
                <div class="col span-1-of-2">
                    Copyright © Pluviophile All Rights Reserved
                    <br>
                    상호명 플루비오파일  대표 : 권서현 <br> 사업자등록번호 : 478-25-01092 고객지원 : 070-8094-0395
                </div>
                <div class="col span-1-of-2">
                    <ul class="social-links">
                        <li><a href="https://www.facebook.com/dozing_dozy-105121864754195/"><i class="ion-social-facebook"></i></a></li>
                        <li><a href="https://www.instagram.com/dozing_dozy/"><i class="ion-social-instagram"></i></a></li>
                    </ul>
                </div>
            </div>
        </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/respond/1.4.2/respond.min.js"></script>
    <script src="//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdn.jsdelivr.net/selectivizr/1.0.3b/selectivizr.min.js"></script>
    <script src="vendors/js/jquery.waypoints.min.js"></script>
    <script src="static/js/script.js"></script>
    <script src="static/js/calculate.js"></script>
    <script src="https://ssl.daumcdn.net/dmaps/map_js_init/postcode.v2.js"></script>
    <script>
// Set the date we're counting down to
var countDownDate = new Date("Mar 29, 2021 00:00:00").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

  // Get today's date and time
  var now = new Date().getTime();
    
  // Find the distance between now and the count down date
  var distance = countDownDate - now;
    
  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
  // Output the result in an element with id="demo"
  document.getElementById("demo").innerHTML = days + "일 " + hours + "시간 "
  + minutes + "분 " + seconds + "초 ";
    
  // If the count down is over, write some text 
  if (distance < 0) {
    clearInterval(x);
    document.getElementById("demo").innerHTML = "EXPIRED";
  }
}, 1000);
</script>
<script>
function openZipSearch() {
new daum.Postcode({
    oncomplete: function(data) {
        $('[name=zip]').val(data.zonecode); // 우편번호 (5자리)
        $('[name=addr1]').val(data.address);
        $('[name=addr2]').val(data.buildingName);
    }
}).open();
}
    
$(document).ready(function() {
    $(".qty").on("change keyup",calculateTotal)
})
    
function myFunction() {
  document.getElementById("orderpage").style.display = "block";
}
    
function myFunction2() {
  document.getElementById("orderpage").style.display = "block";
}
    
    
function closefunc() {
  document.getElementById("orderpage").style.display = "none";
}


</script>
<script type="text/javascript"src="https://cdn.jsdelivr.net/npm/emailjs-com@2/dist/email.min.js"></script>
    <script type="text/javascript">
        // emailJS 사용하기 위한 초기화 작업
        (function() {
            emailjs.init("user_FHcm6IarN4nZTRxxaHUHd");
        })();
        
        
        // 이메일 보내기 함수
        function sendEmail() {

            // input 값 받아오기
            const cozy = document.getElementsByName('cozy')[0].value;
            const dozy = document.getElementsByName('dozy')[0].value;
            const docozy = document.getElementsByName('docozy')[0].value;
            
            
            const name = document.getElementsByName('name')[0].value;
            const tel = document.getElementsByName('tel')[0].value;
            const zip = document.getElementsByName('zip')[0].value;
            const addr1 = document.getElementsByName('addr1')[0].value;
            const addr2 = document.getElementsByName('addr2')[0].value;
            
            const finalamount = document.getElementsByName('finalamount2')[0].value;
            const name_bank = document.getElementsByName('name_bank')[0].value;
            
            console.log(finalamount);

            // 양식 검증 : 빈칸이 있는지 체크 + 이메일 양식 체크
            if(cozy === 0 && dozy === 0 && docozy == 0 ){
                alert('상품 개수를 입력하세요.')
                return;
            }
            
            if(name === ''){
                alert('이름을 입력해 주세요.')
                return;
            }
            if(tel === ''){
                alert('전화번호를 입력해 주세요.')
                return;
            }
            if(addr1 === ''){
                alert('주소를 입력해 주세요.')
                return;
            }
            if(addr2 === ''){
                alert('주소를 입력해 주세요.')
                return;
            }
            if(name_bank === ''){
                alert('입금자명을 입력해 주세요.')
                return;
            }

            // emailJS로 보낼 파라미터 변수
            const templateParams = {
                cozy,
                dozy,
                docozy,                
                name,
                tel,
                zip,
                addr1,
                addr2,
                finalamount,
                name_bank,
            }

            // emailJS 요청 보내기 / 응답 처리
            emailjs.send('service_lj34lrf', 'template_1f8am15', templateParams)
                .then((res) => {
                    // 성공
                    console.log('success :', res.text);
location.replace("dozy_ordered.html"); // 새로고침
                }, (err) => {
                    // 에러
                    console.log('error :', err);
                });
        }
    </script>
    </body>  
    
</html>